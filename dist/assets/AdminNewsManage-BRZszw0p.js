import{r as se,a1 as j,c as I,e as k,h as s,i as l,j as r,w as a,t as m,F as M,k as R,p as c,q as i,s as ae,ac as oe,f as C,g as $,a0 as de,E as T}from"./index-U0bzlslD.js";import{m as ne}from"./mockNews-C-dTu_pP.js";const ie={class:"space-y-6"},re={class:"flex flex-col md:flex-row md:justify-between md:items-center gap-4"},ue={class:"flex items-center gap-3 self-end md:self-auto"},pe={class:"bg-white rounded-xl border border-gray-100 p-4 flex flex-col md:flex-row justify-between items-start md:items-center gap-4"},me={class:"flex items-center gap-3 w-full md:w-auto overflow-x-auto no-scrollbar"},ce={class:"text-gray-500 text-sm whitespace-nowrap"},ge={class:"flex gap-2 w-full md:w-auto"},fe={class:"bg-white rounded-xl border border-gray-100 p-4 md:p-6"},be={class:"flex justify-between items-center mb-4"},xe={class:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4"},_e={class:"col-span-2 md:col-span-1"},ve={class:"col-span-2 md:col-span-1"},ye={class:"col-span-2 md:col-span-1"},we={class:"col-span-2 md:col-span-1 flex items-end"},Ve={class:"bg-white rounded-xl border border-gray-100 overflow-hidden"},he={class:"flex gap-4 py-2"},ke=["src"],Ce={class:"flex flex-col justify-between py-0.5 min-w-0"},Ue=["title"],ze={class:"flex gap-2 mt-2"},Se={class:"text-gray-600"},je={class:"text-gray-900"},Te={class:"text-gray-600 text-sm"},Ne={class:"flex items-center gap-2"},De={class:"md:hidden space-y-4 p-4"},Ee={class:"flex gap-3 mb-3"},Le=["src"],Me={class:"flex-1 min-w-0 flex flex-col justify-between"},Re={class:"font-medium text-gray-900 line-clamp-2 leading-snug"},$e={class:"flex items-center justify-between mt-1"},Be={class:"text-xs text-gray-500"},Fe={class:"flex flex-wrap gap-2 mb-3"},Ye={class:"flex justify-between items-center text-xs text-gray-500 border-t border-gray-50 pt-3"},Ae={class:"flex gap-3"},He={class:"flex gap-2"},Ie={class:"p-4 flex items-center justify-center md:justify-between border-t border-gray-100"},Oe={class:"hidden md:inline text-gray-500 text-sm"},Pe={class:"grid grid-cols-2 gap-4"},qe={class:"flex gap-4 items-start w-full"},Ke=["src"],Ge={class:"flex flex-col gap-2"},Je={class:"flex justify-end gap-2"},Ze={__name:"AdminNewsManage",setup(Qe){const O=ne.map(d=>({...d,tags:d.tags||["行业动态","无人机"]})),v=se(O),n=j({keyword:"",category:"",status:"",source:"",author:"",tag:"",dateRange:null}),f=j({count:0,all:!1,indeterminate:!1,rows:[]}),x=j({page:1,pageSize:10}),N=I(()=>{const d=n.keyword.trim().toLowerCase();return v.value.filter(e=>{const z=!d||[e.title,e.desc].some(_=>String(_).toLowerCase().includes(d)),D=!n.category||e.category===n.category,E=!n.status||e.status===n.status,p=!n.author||e.author.includes(n.author);return z&&D&&E&&p})}),U=I(()=>{const d=(x.page-1)*x.pageSize;return N.value.slice(d,d+x.pageSize)}),P=d=>{f.rows=d,f.count=d.length,f.all=d.length>0&&d.length===U.value.length,f.indeterminate=d.length>0&&d.length<U.value.length},q=d=>{},K=()=>{n.keyword="",n.category="",n.status="",n.source="",n.author="",n.tag="",n.dateRange=null},G=()=>{x.page=1},g=j({visible:!1,mode:"create"}),o=j({id:null,title:"",category:"",cover:"",desc:"",author:"",status:"published",tags:[],publishTime:""}),J=()=>{o.id=null,o.title="",o.category="行业资讯",o.cover="",o.desc="",o.author="",o.status="published",o.tags=[],o.publishTime=new Date().toISOString().slice(0,19).replace("T"," ")},Q=()=>{g.mode="create",J(),g.visible=!0},B=d=>{g.mode="edit",Object.assign(o,d),o.tags=d.tags?[...d.tags]:[],g.visible=!0},W=()=>{if(!o.title)return T.warning("请填写标题");const d={...o};if(g.mode==="create")d.id=Date.now(),d.views=0,v.value.unshift(d),T.success("已创建");else{const e=v.value.findIndex(z=>z.id===o.id);e>-1&&(v.value[e]={...v.value[e],...d},T.success("已更新"))}g.visible=!1},F=d=>{de.confirm(`确认删除文章「${d.title}」？`,"提示",{type:"warning"}).then(()=>{v.value=v.value.filter(e=>e.id!==d.id),T.success("已删除")})};return(d,e)=>{const z=r("el-avatar"),D=r("el-checkbox"),E=r("el-icon"),p=r("el-button"),_=r("el-dropdown-item"),Y=r("el-dropdown-menu"),A=r("el-dropdown"),V=r("el-input"),u=r("el-option"),h=r("el-select"),H=r("el-date-picker"),y=r("el-table-column"),S=r("el-tag"),X=r("el-table"),Z=r("el-pagination"),w=r("el-form-item"),L=r("el-radio"),ee=r("el-radio-group"),le=r("el-form"),te=r("el-dialog");return c(),k("div",ie,[s("div",re,[e[21]||(e[21]=s("div",null,[s("h1",{class:"text-xl md:text-2xl font-bold text-gray-900"},"文章管理"),s("p",{class:"text-gray-500 text-xs md:text-sm mt-1"},"管理平台所有文章内容，包括创建、编辑、发布和下架")],-1)),s("div",ue,[e[20]||(e[20]=s("span",{class:"text-sm text-gray-700"},"张编辑",-1)),l(z,{size:32,src:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"})])]),s("div",pe,[s("div",me,[l(D,{modelValue:f.all,"onUpdate:modelValue":e[0]||(e[0]=t=>f.all=t),indeterminate:f.indeterminate,onChange:q},null,8,["modelValue","indeterminate"]),l(A,{trigger:"click",disabled:f.count===0},{dropdown:a(()=>[l(Y,null,{default:a(()=>[l(_,null,{default:a(()=>[...e[23]||(e[23]=[i("批量发布",-1)])]),_:1}),l(_,null,{default:a(()=>[...e[24]||(e[24]=[i("批量下架",-1)])]),_:1}),l(_,{divided:"",type:"danger"},{default:a(()=>[...e[25]||(e[25]=[i("批量删除",-1)])]),_:1})]),_:1})]),default:a(()=>[l(p,null,{default:a(()=>[e[22]||(e[22]=i(" 批量操作 ",-1)),l(E,{class:"el-icon--right"},{default:a(()=>[l(ae(oe))]),_:1})]),_:1})]),_:1},8,["disabled"]),s("span",ce,"已选中 "+m(f.count)+" 项",1)]),s("div",ge,[l(p,{icon:"Upload",class:"flex-1 md:flex-none"},{default:a(()=>[...e[26]||(e[26]=[i("导入",-1)])]),_:1}),l(p,{icon:"Download",class:"flex-1 md:flex-none"},{default:a(()=>[...e[27]||(e[27]=[i("导出",-1)])]),_:1}),l(p,{type:"primary",icon:"Plus",onClick:Q,class:"flex-1 md:flex-none"},{default:a(()=>[...e[28]||(e[28]=[i("新建文章",-1)])]),_:1})])]),s("div",fe,[s("div",be,[e[30]||(e[30]=s("h3",{class:"font-medium text-gray-900"},"内容筛选",-1)),l(p,{link:"",type:"primary",onClick:K},{default:a(()=>[...e[29]||(e[29]=[i("重置筛选条件",-1)])]),_:1})]),s("div",xe,[s("div",_e,[e[31]||(e[31]=s("label",{class:"block text-xs text-gray-500 mb-1"},"标题",-1)),l(V,{modelValue:n.keyword,"onUpdate:modelValue":e[1]||(e[1]=t=>n.keyword=t),placeholder:"请输入标题关键词","prefix-icon":"Search"},null,8,["modelValue"])]),s("div",null,[e[32]||(e[32]=s("label",{class:"block text-xs text-gray-500 mb-1"},"栏目",-1)),l(h,{modelValue:n.category,"onUpdate:modelValue":e[2]||(e[2]=t=>n.category=t),placeholder:"全部栏目",class:"w-full",clearable:""},{default:a(()=>[l(u,{label:"行业资讯",value:"行业资讯"}),l(u,{label:"政策法规",value:"政策法规"}),l(u,{label:"行业动态",value:"行业动态"}),l(u,{label:"企业动态",value:"企业动态"}),l(u,{label:"招标信息",value:"招标信息"})]),_:1},8,["modelValue"])]),s("div",null,[e[33]||(e[33]=s("label",{class:"block text-xs text-gray-500 mb-1"},"状态",-1)),l(h,{modelValue:n.status,"onUpdate:modelValue":e[3]||(e[3]=t=>n.status=t),placeholder:"全部状态",class:"w-full",clearable:""},{default:a(()=>[l(u,{label:"已发布",value:"published"}),l(u,{label:"草稿",value:"draft"}),l(u,{label:"待审核",value:"pending"})]),_:1},8,["modelValue"])]),s("div",ve,[e[34]||(e[34]=s("label",{class:"block text-xs text-gray-500 mb-1"},"发布时间",-1)),l(H,{modelValue:n.dateRange,"onUpdate:modelValue":e[4]||(e[4]=t=>n.dateRange=t),type:"daterange","range-separator":"-","start-placeholder":"开始","end-placeholder":"结束",class:"w-full",style:{width:"100%"}},null,8,["modelValue"])]),s("div",null,[e[35]||(e[35]=s("label",{class:"block text-xs text-gray-500 mb-1"},"来源",-1)),l(h,{modelValue:n.source,"onUpdate:modelValue":e[5]||(e[5]=t=>n.source=t),placeholder:"全部来源",class:"w-full",clearable:""},{default:a(()=>[l(u,{label:"原创",value:"original"}),l(u,{label:"转载",value:"repost"})]),_:1},8,["modelValue"])]),s("div",null,[e[36]||(e[36]=s("label",{class:"block text-xs text-gray-500 mb-1"},"标签",-1)),l(h,{modelValue:n.tag,"onUpdate:modelValue":e[6]||(e[6]=t=>n.tag=t),placeholder:"全部标签",class:"w-full",clearable:""},{default:a(()=>[l(u,{label:"推荐",value:"recommend"}),l(u,{label:"置顶",value:"top"})]),_:1},8,["modelValue"])]),s("div",ye,[e[37]||(e[37]=s("label",{class:"block text-xs text-gray-500 mb-1"},"作者",-1)),l(V,{modelValue:n.author,"onUpdate:modelValue":e[7]||(e[7]=t=>n.author=t),placeholder:"请输入作者名称","prefix-icon":"User"},null,8,["modelValue"])]),s("div",we,[l(p,{type:"primary",class:"w-full",onClick:G},{default:a(()=>[...e[38]||(e[38]=[i("查询",-1)])]),_:1})])])]),s("div",Ve,[l(X,{data:U.value,style:{width:"100%"},onSelectionChange:P,class:"hidden md:block"},{default:a(()=>[l(y,{type:"selection",width:"55"}),l(y,{label:"标题","min-width":"400"},{default:a(({row:t})=>[s("div",he,[s("img",{src:t.cover,class:"w-32 h-20 object-cover rounded-lg border border-gray-100 bg-gray-50 flex-shrink-0"},null,8,ke),s("div",Ce,[s("div",{class:"font-medium text-gray-900 truncate text-base",title:t.title},m(t.title),9,Ue),s("div",ze,[(c(!0),k(M,null,R(t.tags||[],b=>(c(),C(S,{key:b,size:"small",effect:"plain",class:"!bg-blue-50 !text-blue-600 !border-blue-100"},{default:a(()=>[i(" #"+m(b),1)]),_:2},1024))),128)),!t.tags||t.tags.length===0?(c(),C(S,{key:0,size:"small",type:"info",effect:"plain"},{default:a(()=>[...e[39]||(e[39]=[i("无标签",-1)])]),_:1})):$("",!0)])])])]),_:1}),l(y,{prop:"category",label:"栏目",width:"120"},{default:a(({row:t})=>[s("span",Se,m(t.category),1)]),_:1}),l(y,{prop:"status",label:"状态",width:"100"},{default:a(({row:t})=>[l(S,{type:t.status==="published"?"success":"info",effect:"light",round:""},{default:a(()=>[i(m(t.status==="published"?"已发布":"草稿"),1)]),_:2},1032,["type"])]),_:1}),l(y,{prop:"views",label:"阅读量",width:"100"},{default:a(({row:t})=>[s("div",je,m(t.views.toLocaleString()),1)]),_:1}),l(y,{prop:"publishTime",label:"发布时间",width:"180"},{default:a(({row:t})=>[s("div",Te,m(t.publishTime),1)]),_:1}),l(y,{label:"操作",width:"150",fixed:"right"},{default:a(({row:t})=>[s("div",Ne,[l(p,{circle:"",size:"small",icon:"View"}),l(p,{circle:"",size:"small",type:"primary",icon:"Edit",onClick:b=>B(t)},null,8,["onClick"]),l(A,{trigger:"click"},{dropdown:a(()=>[l(Y,null,{default:a(()=>[l(_,{onClick:b=>F(t),class:"text-red-500"},{default:a(()=>[...e[40]||(e[40]=[i("删除",-1)])]),_:1},8,["onClick"]),t.status==="published"?(c(),C(_,{key:0},{default:a(()=>[...e[41]||(e[41]=[i("下架",-1)])]),_:1})):(c(),C(_,{key:1},{default:a(()=>[...e[42]||(e[42]=[i("发布",-1)])]),_:1}))]),_:2},1024)]),default:a(()=>[l(p,{circle:"",size:"small",icon:"More"})]),_:2},1024)])]),_:1})]),_:1},8,["data"]),s("div",De,[(c(!0),k(M,null,R(U.value,t=>(c(),k("div",{key:t.id,class:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm"},[s("div",Ee,[s("img",{src:t.cover,class:"w-24 h-20 object-cover rounded-lg border border-gray-100 bg-gray-50 flex-shrink-0"},null,8,Le),s("div",Me,[s("div",Re,m(t.title),1),s("div",$e,[s("span",Be,m(t.category),1),l(S,{type:t.status==="published"?"success":"info",size:"small",effect:"light",round:""},{default:a(()=>[i(m(t.status==="published"?"已发布":"草稿"),1)]),_:2},1032,["type"])])])]),s("div",Fe,[(c(!0),k(M,null,R(t.tags||[],b=>(c(),C(S,{key:b,size:"small",effect:"plain",class:"!bg-blue-50 !text-blue-600 !border-blue-100"},{default:a(()=>[i(" #"+m(b),1)]),_:2},1024))),128))]),s("div",Ye,[s("div",Ae,[s("span",null,"阅读 "+m(t.views),1),s("span",null,m(t.publishTime.split(" ")[0]),1)]),s("div",He,[l(p,{size:"small",icon:"Edit",circle:"",onClick:b=>B(t)},null,8,["onClick"]),l(p,{size:"small",icon:"Delete",circle:"",type:"danger",plain:"",onClick:b=>F(t)},null,8,["onClick"])])])]))),128))]),s("div",Ie,[s("span",Oe,"显示 "+m(U.value.length)+" 条，共 "+m(N.value.length)+" 条",1),l(Z,{"current-page":x.page,"onUpdate:currentPage":e[8]||(e[8]=t=>x.page=t),"page-size":x.pageSize,"onUpdate:pageSize":e[9]||(e[9]=t=>x.pageSize=t),background:"",layout:"prev, pager, next",total:N.value.length,small:""},null,8,["current-page","page-size","total"])])]),l(te,{modelValue:g.visible,"onUpdate:modelValue":e[19]||(e[19]=t=>g.visible=t),title:g.mode==="create"?"新建文章":"编辑文章",width:"800px"},{footer:a(()=>[s("div",Je,[l(p,{onClick:e[18]||(e[18]=t=>g.visible=!1)},{default:a(()=>[...e[46]||(e[46]=[i("取消",-1)])]),_:1}),l(p,{type:"primary",onClick:W},{default:a(()=>[...e[47]||(e[47]=[i("保存",-1)])]),_:1})])]),default:a(()=>[l(le,{model:o,"label-width":"80px",class:"max-h-[600px] overflow-y-auto pr-4"},{default:a(()=>[l(w,{label:"文章标题"},{default:a(()=>[l(V,{modelValue:o.title,"onUpdate:modelValue":e[10]||(e[10]=t=>o.title=t),placeholder:"请输入文章标题"},null,8,["modelValue"])]),_:1}),s("div",Pe,[l(w,{label:"所属栏目"},{default:a(()=>[l(h,{modelValue:o.category,"onUpdate:modelValue":e[11]||(e[11]=t=>o.category=t),class:"w-full"},{default:a(()=>[l(u,{label:"行业资讯",value:"行业资讯"}),l(u,{label:"政策法规",value:"政策法规"}),l(u,{label:"行业动态",value:"行业动态"}),l(u,{label:"企业动态",value:"企业动态"}),l(u,{label:"招标信息",value:"招标信息"})]),_:1},8,["modelValue"])]),_:1}),l(w,{label:"文章来源"},{default:a(()=>[l(V,{modelValue:o.author,"onUpdate:modelValue":e[12]||(e[12]=t=>o.author=t),placeholder:"请输入来源"},null,8,["modelValue"])]),_:1})]),l(w,{label:"封面图片"},{default:a(()=>[s("div",qe,[l(V,{modelValue:o.cover,"onUpdate:modelValue":e[13]||(e[13]=t=>o.cover=t),placeholder:"请输入图片URL",class:"flex-1"},null,8,["modelValue"]),o.cover?(c(),k("img",{key:0,src:o.cover,class:"w-24 h-16 object-cover rounded border border-gray-200"},null,8,Ke)):$("",!0)])]),_:1}),l(w,{label:"文章摘要"},{default:a(()=>[l(V,{modelValue:o.desc,"onUpdate:modelValue":e[14]||(e[14]=t=>o.desc=t),type:"textarea",rows:3,placeholder:"请输入文章摘要"},null,8,["modelValue"])]),_:1}),l(w,{label:"文章标签"},{default:a(()=>[l(h,{modelValue:o.tags,"onUpdate:modelValue":e[15]||(e[15]=t=>o.tags=t),multiple:"",filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,placeholder:"输入标签后按回车",class:"w-full"},null,8,["modelValue"])]),_:1}),l(w,{label:"发布设置"},{default:a(()=>[s("div",Ge,[l(ee,{modelValue:o.status,"onUpdate:modelValue":e[16]||(e[16]=t=>o.status=t)},{default:a(()=>[l(L,{value:"published"},{default:a(()=>[...e[43]||(e[43]=[i("立即发布",-1)])]),_:1}),l(L,{value:"draft"},{default:a(()=>[...e[44]||(e[44]=[i("存为草稿",-1)])]),_:1}),l(L,{value:"pending"},{default:a(()=>[...e[45]||(e[45]=[i("提交审核",-1)])]),_:1})]),_:1},8,["modelValue"]),o.status==="published"?(c(),C(H,{key:0,modelValue:o.publishTime,"onUpdate:modelValue":e[17]||(e[17]=t=>o.publishTime=t),type:"datetime",placeholder:"选择发布时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])):$("",!0)])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}};export{Ze as default};
