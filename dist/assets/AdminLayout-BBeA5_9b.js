import{b as R,u as F,c as x,j as u,f as b,p,w as t,e as q,g as B,F as L,i as e,s,K as ee,q as f,h as a,L as te,M as le,N as ne,O as se,P as ae,Q as de,R as re,S as ie,T as oe,U as ue,V as j,x as z,W as D,r as k,o as fe,X as pe,E as U,m as me,Y as ve,Z as _e,t as h,$ as ce,a0 as xe}from"./index-U0bzlslD.js";const O={__name:"AdminSideMenu",props:{isCollapse:{type:Boolean,default:!1}},setup(S){const V=R(),{user:g,activeIdentity:d}=F(),C=x(()=>{var _;return((_=g.value)==null?void 0:_.role)==="admin"}),m=x(()=>d.value&&d.value.startsWith("requester")),v=x(()=>d.value==="provider");return(_,l)=>{const r=u("el-icon"),o=u("el-menu-item"),w=u("el-sub-menu"),E=u("el-menu");return p(),b(E,{"default-active":s(V).path,class:"border-0 w-full",router:"",collapse:S.isCollapse},{default:t(()=>[C.value?(p(),q(L,{key:0},[e(o,{index:"/admin/dashboard"},{title:t(()=>[...l[0]||(l[0]=[f("总览",-1)])]),default:t(()=>[e(r,null,{default:t(()=>[e(s(ee))]),_:1})]),_:1}),e(w,{index:"users"},{title:t(()=>[e(r,null,{default:t(()=>[e(s(ne))]),_:1}),l[1]||(l[1]=a("span",null,"用户管理",-1))]),default:t(()=>[e(o,{index:"/admin/users/c"},{default:t(()=>[e(r,null,{default:t(()=>[e(s(te))]),_:1}),l[2]||(l[2]=a("span",null,"C端用户管理",-1))]),_:1}),e(o,{index:"/admin/providers"},{default:t(()=>[e(r,null,{default:t(()=>[e(s(le))]),_:1}),l[3]||(l[3]=a("span",null,"B端用户管理",-1))]),_:1})]),_:1}),e(w,{index:"business"},{title:t(()=>[e(r,null,{default:t(()=>[e(s(ae))]),_:1}),l[4]||(l[4]=a("span",null,"业务管理",-1))]),default:t(()=>[e(o,{index:"/admin/needs"},{default:t(()=>[e(r,null,{default:t(()=>[e(s(se))]),_:1}),l[5]||(l[5]=a("span",null,"需求管理",-1))]),_:1})]),_:1}),e(w,{index:"content"},{title:t(()=>[e(r,null,{default:t(()=>[e(s(ue))]),_:1}),l[6]||(l[6]=a("span",null,"内容管理",-1))]),default:t(()=>[e(o,{index:"/admin/news"},{default:t(()=>[e(r,null,{default:t(()=>[e(s(de))]),_:1}),l[7]||(l[7]=a("span",null,"文章管理",-1))]),_:1}),e(o,{index:"/admin/audit"},{default:t(()=>[e(r,null,{default:t(()=>[e(s(re))]),_:1}),l[8]||(l[8]=a("span",null,"审核管理",-1))]),_:1}),e(o,{index:"/admin/category"},{default:t(()=>[e(r,null,{default:t(()=>[e(s(ie))]),_:1}),l[9]||(l[9]=a("span",null,"栏目管理",-1))]),_:1}),e(o,{index:"/admin/news/featured"},{default:t(()=>[e(r,null,{default:t(()=>[e(s(oe))]),_:1}),l[10]||(l[10]=a("span",null,"首页推荐",-1))]),_:1})]),_:1})],64)):m.value?(p(),q(L,{key:1},[e(o,{index:"/admin/requester/dashboard"},{title:t(()=>[...l[11]||(l[11]=[f("工作台",-1)])]),default:t(()=>[e(r,null,{default:t(()=>[e(s(j))]),_:1})]),_:1}),e(o,{index:"/admin/messages"},{title:t(()=>[...l[12]||(l[12]=[f("消息中心",-1)])]),default:t(()=>[e(r,null,{default:t(()=>[e(s(z))]),_:1})]),_:1}),e(o,{index:"/admin/profile"},{title:t(()=>[...l[13]||(l[13]=[f("账号设置",-1)])]),default:t(()=>[e(r,null,{default:t(()=>[e(s(D))]),_:1})]),_:1})],64)):v.value?(p(),q(L,{key:2},[e(o,{index:"/admin/provider/dashboard"},{title:t(()=>[...l[14]||(l[14]=[f("工作台",-1)])]),default:t(()=>[e(r,null,{default:t(()=>[e(s(j))]),_:1})]),_:1}),e(o,{index:"/admin/messages"},{title:t(()=>[...l[15]||(l[15]=[f("消息中心",-1)])]),default:t(()=>[e(r,null,{default:t(()=>[e(s(z))]),_:1})]),_:1}),e(o,{index:"/admin/profile"},{title:t(()=>[...l[16]||(l[16]=[f("账号设置",-1)])]),default:t(()=>[e(r,null,{default:t(()=>[e(s(D))]),_:1})]),_:1})],64)):B("",!0)]),_:1},8,["default-active","collapse"])}}},ge={class:"min-h-screen bg-gray-50"},ye={class:"h-16 px-4 flex items-center gap-3 border-b border-gray-100"},be={key:0,class:"min-w-0"},we={class:"flex items-center gap-4 text-gray-500"},ke={class:"text-sm text-gray-400 hidden sm:block"},qe={class:"flex items-center gap-2 md:gap-4"},Ce={class:"flex items-center gap-2 cursor-pointer"},Be={class:"text-sm font-medium text-gray-700 hidden sm:block"},Ee={__name:"AdminLayout",setup(S){const V=R(),g=me(),{user:d,logout:C,activeIdentity:m}=F(),v=k(!1),_=k(!1),l=k(!1),r=k(!1),o=k("provider");x(()=>{var i;return((i=d.value)==null?void 0:i.role)==="admin"}),x(()=>m.value&&m.value.startsWith("requester")),x(()=>m.value==="provider");const w=x(()=>{if(!d.value)return"切换 / 申请身份";const i=d.value.role==="b-user",n=d.value.role==="c-user";return m.value==="provider"?i?"切换为企业需求方":n?"切换为个人需求方":"切换为需求方":m.value&&m.value.startsWith("requester")?i?"切换为企业服务方":n?"切换为个人服务方":"切换为服务方":"切换 / 申请身份"}),E=()=>{C(),g.push("/"),U.success("已退出")},I=async()=>{if(!d.value){U.warning("请先登录");return}let i="provider";const n=d.value.role==="b-user",M=d.value.role==="c-user";m.value==="provider"?n?i="requester_enterprise":M?i="requester_personal":i=d.value.requesterEnterprise?"requester_enterprise":"requester_personal":m.value.startsWith("requester")&&(i="provider");let y=!1;if(i==="provider"?y=!!d.value.providerLevel:i==="requester_enterprise"?y=d.value.requesterEnterprise:y=d.value.requesterPersonal,y)try{await xe.confirm(`切换身份需要重新登录，确认要切换为${i==="provider"?"服务方":"需求方"}身份吗？`,"切换身份",{confirmButtonText:"重新登录",cancelButtonText:"取消",type:"info"}),C(),g.push("/"),typeof window<"u"&&window.dispatchEvent(new Event("open-login-modal"))}catch{}else r.value=!0,o.value=i==="provider"?"provider":"requester",l.value=!0},T=i=>{if(!d.value){U.warning("请先登录");return}const n=i&&i.detail?i.detail:{};r.value=!!n.applicationOnly,o.value=n.mode==="requester"?"requester":"provider",l.value=!0};fe(()=>{typeof window<"u"&&window.addEventListener("open-identity-dialog",T)}),pe(()=>{typeof window<"u"&&window.removeEventListener("open-identity-dialog",T)});const P={"/admin/dashboard":"总览","/admin/needs":"需求管理","/admin/providers":"B端用户管理","/admin/news":"文章管理","/admin/news/featured":"首页推荐","/admin/category":"栏目管理","/admin/audit":"审核管理","/admin/users/c":"C端用户管理","/admin/requester/dashboard":"个人工作台","/admin/requester/publish":"发布需求","/admin/provider/dashboard":"工作台","/admin/market":"任务大厅","/admin/provider/services":"服务能力","/admin/profile":"账号设置","/service-needs":"需求大厅","/messages":"消息中心","/admin/messages":"消息中心"},K=x(()=>P[V.path]||"工作台");return(i,n)=>{const M=u("el-aside"),y=u("el-drawer"),$=u("el-icon"),A=u("el-button"),Q=u("el-avatar"),X=u("el-tag"),N=u("el-dropdown-item"),Y=u("el-dropdown-menu"),Z=u("el-dropdown"),G=u("el-header"),H=u("router-view"),J=u("el-main"),W=u("el-container");return p(),q("div",ge,[e(W,{class:"min-h-screen"},{default:t(()=>[e(M,{width:v.value?"64px":"240px",class:"bg-white border-r border-gray-100 hidden md:block transition-all duration-300"},{default:t(()=>[a("div",ye,[n[8]||(n[8]=a("div",{class:"w-9 h-9 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold flex-shrink-0"},"L",-1)),v.value?B("",!0):(p(),q("div",be,[...n[7]||(n[7]=[a("div",{class:"font-bold text-gray-800 truncate"},"后台管理",-1),a("div",{class:"text-xs text-gray-400 truncate"},"低空场景智慧飞滴",-1)])]))]),e(O,{"is-collapse":v.value},null,8,["is-collapse"])]),_:1},8,["width"]),e(y,{modelValue:_.value,"onUpdate:modelValue":n[1]||(n[1]=c=>_.value=c),direction:"ltr",size:"240px","with-header":!1,class:"md:hidden"},{default:t(()=>[n[9]||(n[9]=a("div",{class:"h-16 px-4 flex items-center gap-3 border-b border-gray-100"},[a("div",{class:"w-9 h-9 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold flex-shrink-0"},"L"),a("div",{class:"min-w-0"},[a("div",{class:"font-bold text-gray-800 truncate"},"后台管理"),a("div",{class:"text-xs text-gray-400 truncate"},"低空场景智慧飞滴")])],-1)),e(O,{"is-collapse":!1,onSelect:n[0]||(n[0]=c=>_.value=!1)})]),_:1},8,["modelValue"]),e(W,null,{default:t(()=>[e(G,{class:"bg-white border-b border-gray-100 flex items-center justify-between px-4 md:px-6 h-16"},{default:t(()=>[a("div",we,[e($,{class:"cursor-pointer hover:text-blue-600 md:hidden text-xl",onClick:n[2]||(n[2]=c=>_.value=!0)},{default:t(()=>[e(s(ve))]),_:1}),e($,{class:"cursor-pointer hover:text-blue-600 hidden md:block text-xl",onClick:n[3]||(n[3]=c=>v.value=!v.value)},{default:t(()=>[(p(),b(_e(v.value?"Expand":"Fold")))]),_:1}),a("span",ke,h(K.value),1)]),a("div",qe,[e(A,{link:"",type:"primary",onClick:n[4]||(n[4]=c=>s(g).push("/")),class:"hidden sm:flex"},{default:t(()=>[...n[10]||(n[10]=[f("返回首页",-1)])]),_:1}),n[14]||(n[14]=a("div",{class:"h-4 w-px bg-gray-200 hidden sm:block"},null,-1)),s(d)?(p(),b(Z,{key:0,trigger:"click"},{dropdown:t(()=>[e(Y,null,{default:t(()=>[s(d).role!=="admin"?(p(),b(N,{key:0,onClick:I},{default:t(()=>[f(h(w.value),1)]),_:1})):B("",!0),e(N,{onClick:E},{default:t(()=>[...n[12]||(n[12]=[f("退出登录",-1)])]),_:1})]),_:1})]),default:t(()=>[a("div",Ce,[e(Q,{size:32,src:s(d).avatar},null,8,["src"]),a("span",Be,h(s(d).nickname||s(d).username),1),s(d).role==="admin"?(p(),b(X,{key:0,size:"small",type:"danger",effect:"dark",class:"hidden sm:flex"},{default:t(()=>[...n[11]||(n[11]=[f("管理员",-1)])]),_:1})):B("",!0)])]),_:1})):(p(),b(A,{key:1,type:"primary",size:"small",onClick:n[5]||(n[5]=c=>s(g).push("/"))},{default:t(()=>[...n[13]||(n[13]=[f("请登录",-1)])]),_:1}))])]),_:1}),e(J,{class:"bg-gray-50 p-4 md:p-6"},{default:t(()=>[e(H)]),_:1}),e(ce,{modelValue:l.value,"onUpdate:modelValue":n[6]||(n[6]=c=>l.value=c),"is-application-only":r.value,"default-mode":o.value},null,8,["modelValue","is-application-only","default-mode"])]),_:1})]),_:1})])}}};export{Ee as default};
