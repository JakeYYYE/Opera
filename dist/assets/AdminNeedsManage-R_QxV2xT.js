import{a1 as D,r as Z,c as q,C as ee,e as U,h as o,i as a,w as s,j as i,s as B,m as te,F as $,k as M,p as w,q as r,y as le,f as P,t as g,n as I,g as L,a0 as ae,E as h}from"./index-U0bzlslD.js";const se={class:"space-y-4"},oe={class:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4"},ne={class:"flex items-center gap-2 w-full md:w-auto"},de={class:"bg-white rounded-xl border border-gray-100 shadow-sm p-5"},ie={class:"flex flex-col lg:flex-row lg:items-center gap-3"},re={class:"flex-1 min-w-0"},ue={class:"w-full lg:w-44"},me={class:"w-full lg:w-44"},pe={class:"md:hidden space-y-4"},ce={class:"flex justify-between items-start mb-2"},ge={class:"font-medium text-gray-800 line-clamp-2 flex-1 mr-2"},fe={class:"flex flex-wrap gap-2 mb-3"},be={class:"grid grid-cols-2 gap-2 text-sm mb-3 text-gray-500"},ve={class:"text-gray-800 font-medium"},xe={class:"col-span-2 text-xs truncate"},ye={class:"flex justify-end gap-2 pt-3 border-t border-gray-50"},_e={class:"bg-white rounded-xl border border-gray-100 shadow-sm hidden md:block"},we={class:"flex flex-col gap-1 min-w-0 py-2"},Ve={class:"flex items-center gap-2"},ke={class:"font-medium text-gray-800 truncate"},he={key:0,class:"bg-red-50 text-red-600 text-xs px-2 py-0.5 rounded font-medium flex-shrink-0"},Te={class:"text-xs text-gray-500 truncate"},Ce={class:"p-4 flex justify-end"},Ue={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ze={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},De={class:"flex justify-end gap-2"},$e={__name:"AdminNeedsManage",setup(Be){const S=te(),p=D({keyword:"",status:"",category:""}),v=Z([{id:1,category:"医疗急救",title:"市中心医院-分院区紧急血液样本每日往返运输服务",desc:"需具备医疗冷链运输资质，每日往返4次，单程距离15km，要求全天候响应能力。需提供符合医疗标准的运输箱及实时温控数据监测。",location:"北京市 · 朝阳区",budget:"¥50,000 / 月",publishTime:"2026-01-12 09:20",deadline:"2026-01-20",status:"进行中",urgent:!0,views:128,attachments:[{name:"运输路线与时段说明.pdf",size:"1.2MB"},{name:"温控数据标准.xlsx",size:"320KB"}],requirements:["具备医疗冷链运输相关资质与案例，支持全链路温控记录与追溯","每日往返4次，单程约15km，可提供应急增派能力与备用机保障","运输箱具备恒温/保温能力，支持实时温度记录与异常告警","需配合医院取样流程，做到交接签收、时间戳记录与异常处置"],deliverables:[{name:"日运输记录",desc:"每趟签收、温控曲线、异常记录",format:"PDF/Excel"},{name:"月度服务报告",desc:"准点率、异常处置、优化建议",format:"PDF"}],owner:{org:"市中心医院",name:"张主任",phone:"138****1024"}},{id:2,category:"巡检监测",title:"2026年度西山森林防火期无人机常态化巡查项目",desc:"覆盖林区面积约3000亩，要求具备红外热成像功能，能识别早期火点并自动报警。需提供每日巡检报告及异常情况实时图传。",location:"北京市 · 海淀区",budget:"¥280,000",publishTime:"2026-01-11 14:05",deadline:"2026-01-25",status:"进行中",urgent:!1,views:456,attachments:[{name:"巡检范围示意图.kml",size:"860KB"}],requirements:["覆盖巡检范围约3000亩，制定巡检航线与应急航线两套方案","具备红外热成像能力，可识别早期火点并自动告警","支持异常情况实时图传，提供当日巡检报告与问题闭环记录"],deliverables:[{name:"每日巡检报告",desc:"航线、覆盖率、异常点位与截图",format:"PDF"},{name:"告警处置记录",desc:"告警信息、处置过程、结果归档",format:"PDF/Excel"}],owner:{org:"西山林场管理处",name:"李科长",phone:"139****6630"}},{id:3,category:"地理测绘",title:"通州副中心某新建园区高精度倾斜摄影建模",desc:"测区面积2平方公里，要求地面分辨率优于3cm，输出OSGB及3DTiles格式模型。工期要求：外业采集3天，内业处理7天。",location:"北京市 · 通州区",budget:"¥45,000",publishTime:"2026-01-11 09:30",deadline:"2026-01-22",status:"进行中",urgent:!1,views:89,attachments:[{name:"测区边界.shp",size:"2.4MB"}],requirements:["测区面积约2平方公里，GSD优于3cm，满足倾斜摄影采集规范","输出OSGB与3DTiles模型，提供浏览与质检说明","工期：外业3天，内业7天，提交阶段成果与验收材料"],deliverables:[{name:"OSGB实景模型",desc:"含纹理、坐标信息与浏览说明",format:"OSGB"},{name:"3DTiles模型",desc:"支持Cesium加载的tileset",format:"3DTiles"}],owner:{org:"通州副中心管委会",name:"王工",phone:"136****9081"}},{id:4,category:"农林植保",title:"大兴区西瓜种植基地春季病虫害防治飞防服务",desc:"作业面积5000亩，主要防治蚜虫、红蜘蛛。要求使用T40或同级别以上机型，需自带药剂配比方案。",location:"北京市 · 大兴区",budget:"¥15 / 亩",publishTime:"2026-01-10 16:45",deadline:"2026-01-18",status:"进行中",urgent:!1,views:210,attachments:[],requirements:["作业面积5000亩，按地块分批次完成，需提供作业计划与人员机组安排","机型要求T40或同级别以上，具备精准喷洒与断点续喷能力","提供药剂配比方案与安全用药说明，作业后提交作业轨迹与面积统计"],deliverables:[{name:"作业轨迹与面积统计",desc:"含地块、面积、时间与轨迹文件",format:"PDF/Excel"},{name:"作业照片/视频",desc:"关键地块作业留痕与效果证明",format:"JPG/MP4"}],owner:{org:"大兴区农业合作社",name:"赵队长",phone:"137****5512"}},{id:5,category:"文旅体验",title:"慕田峪长城春季宣传片航拍素材采集",desc:"需要专业的FPV飞手及航拍团队，拍摄日出、云海及长城春色。要求4K 60fps以上画质，需配合地面导演组进行多机位协同。",location:"北京市 · 怀柔区",budget:"¥12,000 / 天",publishTime:"2026-01-09 11:10",deadline:"2026-01-16",status:"进行中",urgent:!1,views:340,attachments:[{name:"分镜脚本与景别清单.docx",size:"540KB"}],requirements:["FPV飞手与航拍团队具备商业拍摄经验，提供作品集与设备清单","画质要求4K 60fps以上，具备ND镜与夜景拍摄辅助能力","配合地面导演组进行多机位协同，按分镜完成素材交付"],deliverables:[{name:"原始素材",desc:"按分镜编号整理交付",format:"MOV/MP4"},{name:"航拍数据清单",desc:"含拍摄时间、机位、参数与备注",format:"Excel"}],owner:{org:"慕田峪景区运营中心",name:"刘导演",phone:"135****2209"}}]),V=D({page:1,pageSize:10}),F=q(()=>Array.from(new Set(v.value.map(n=>n.category))).filter(Boolean)),E=q(()=>{const n=p.keyword.trim().toLowerCase();return v.value.filter(e=>{var f,y;const u=!n||[e.title,e.location,e.category,(f=e.owner)==null?void 0:f.org,(y=e.owner)==null?void 0:y.name].some(T=>String(T).toLowerCase().includes(n)),C=!p.status||e.status===p.status,m=!p.category||e.category===p.category;return u&&C&&m})}),N=q(()=>{const n=(V.page-1)*V.pageSize;return E.value.slice(n,n+V.pageSize)});ee(()=>[p.keyword,p.status,p.category],()=>{V.page=1});const x=D({visible:!1,mode:"create"}),l=D({id:null,title:"",category:"",location:"",budget:"",deadline:"",status:"进行中",urgent:!1,publishTime:"",views:0,desc:"",requirementsText:"",deliverablesText:"",owner:{org:"",name:"",phone:""}}),A=()=>{l.id=null,l.title="",l.category="",l.location="",l.budget="",l.deadline="",l.status="进行中",l.urgent=!1,l.publishTime=new Date().toISOString().slice(0,16).replace("T"," "),l.views=0,l.desc="",l.requirementsText="",l.deliverablesText="",l.owner={org:"",name:"",phone:""}},H=()=>{x.mode="create",A(),x.visible=!0},j=n=>{x.mode="edit",l.id=n.id,l.title=n.title,l.category=n.category,l.location=n.location,l.budget=n.budget,l.deadline=n.deadline,l.status=n.status,l.urgent=!!n.urgent,l.publishTime=n.publishTime,l.views=n.views,l.desc=n.desc,l.requirementsText=(n.requirements||[]).join(`
`),l.deliverablesText=(n.deliverables||[]).map(e=>`${e.name} | ${e.desc} | ${e.format}`).join(`
`),l.owner={...n.owner},x.visible=!0},R=()=>{const n=l.title.trim(),e=l.category.trim(),u=l.location.trim(),C=l.budget.trim(),m=l.deadline,f=l.status;if(!n)return h.warning("请填写标题");if(!e)return h.warning("请填写分类");if(!u)return h.warning("请填写区域");if(!C)return h.warning("请填写预算");if(!m)return h.warning("请选择截止日期");const y=l.requirementsText.split(`
`).map(c=>c.trim()).filter(Boolean),T=l.deliverablesText.split(`
`).map(c=>{const _=c.split("|").map(d=>d.trim());return{name:_[0]||"",desc:_[1]||"",format:_[2]||""}}).filter(c=>c.name),b={title:n,category:e,location:u,budget:C,deadline:m,status:f,urgent:!!l.urgent,publishTime:l.publishTime,views:l.views,desc:l.desc,requirements:y,deliverables:T,owner:{...l.owner},attachments:[]};if(x.mode==="create"){const c=Math.max(0,...v.value.map(_=>Number(_.id)||0))+1;v.value=[{id:c,...b},...v.value],h.success("已新增需求")}else{const c=v.value.findIndex(_=>_.id===l.id);c>=0&&(v.value.splice(c,1,{...v.value[c],...b}),h.success("已保存修改"))}x.visible=!1},Y=async n=>{try{await ae.confirm(`确认删除「${n.title}」？`,"删除确认",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}),v.value=v.value.filter(e=>e.id!==n.id),h.success("已删除")}catch{return}};return(n,e)=>{const u=i("el-button"),C=i("el-icon"),m=i("el-input"),f=i("el-option"),y=i("el-select"),T=i("el-tag"),b=i("el-table-column"),c=i("el-table"),_=i("el-pagination"),d=i("el-form-item"),G=i("el-date-picker"),J=i("el-switch"),Q=i("el-input-number"),K=i("el-divider"),W=i("el-form"),X=i("el-dialog");return w(),U("div",se,[o("div",oe,[e[25]||(e[25]=o("div",null,[o("h1",{class:"text-xl md:text-2xl font-bold text-gray-800"},"需求管理"),o("p",{class:"text-gray-500 text-sm mt-1"},"维护需求信息，确保前台展示一致")],-1)),o("div",ne,[a(u,{class:"flex-1 md:flex-none",type:"primary",onClick:H},{default:s(()=>[...e[23]||(e[23]=[r("新增需求",-1)])]),_:1}),a(u,{class:"flex-1 md:flex-none",type:"primary",plain:"",onClick:e[0]||(e[0]=t=>B(S).push("/service-needs"))},{default:s(()=>[...e[24]||(e[24]=[r("前台大厅",-1)])]),_:1})])]),o("div",de,[o("div",ie,[o("div",re,[a(m,{modelValue:p.keyword,"onUpdate:modelValue":e[1]||(e[1]=t=>p.keyword=t),placeholder:"搜索标题/区域/分类",clearable:""},{prefix:s(()=>[a(C,null,{default:s(()=>[a(B(le))]),_:1})]),_:1},8,["modelValue"])]),o("div",ue,[a(y,{modelValue:p.status,"onUpdate:modelValue":e[2]||(e[2]=t=>p.status=t),placeholder:"状态",clearable:"",class:"w-full"},{default:s(()=>[a(f,{label:"进行中",value:"进行中"}),a(f,{label:"已结束",value:"已结束"})]),_:1},8,["modelValue"])]),o("div",me,[a(y,{modelValue:p.category,"onUpdate:modelValue":e[3]||(e[3]=t=>p.category=t),placeholder:"分类",clearable:"",class:"w-full"},{default:s(()=>[(w(!0),U($,null,M(F.value,t=>(w(),P(f,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])]),o("div",pe,[(w(!0),U($,null,M(N.value,t=>{var k,z;return w(),U("div",{key:t.id,class:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm"},[o("div",ce,[o("div",ge,g(t.title),1),o("span",{class:I(["text-xs px-2 py-1 rounded-full whitespace-nowrap",t.status==="进行中"?"bg-blue-50 text-blue-600":"bg-gray-100 text-gray-600"])},g(t.status),3)]),o("div",fe,[a(T,{size:"small",type:"info"},{default:s(()=>[r(g(t.category),1)]),_:2},1024),a(T,{size:"small",type:"warning",plain:""},{default:s(()=>[r(g(t.location),1)]),_:2},1024),t.urgent?(w(),P(T,{key:0,type:"danger",size:"small",effect:"dark"},{default:s(()=>[...e[26]||(e[26]=[r("紧急",-1)])]),_:1})):L("",!0)]),o("div",be,[o("div",null,[e[27]||(e[27]=r("预算: ",-1)),o("span",ve,g(t.budget),1)]),o("div",null,"截止: "+g(t.deadline),1),o("div",xe,g((k=t.owner)==null?void 0:k.org)+" · "+g((z=t.owner)==null?void 0:z.name),1)]),o("div",ye,[a(u,{size:"small",type:"primary",link:"",onClick:O=>j(t)},{default:s(()=>[...e[28]||(e[28]=[r("编辑",-1)])]),_:1},8,["onClick"]),a(u,{size:"small",type:"danger",link:"",onClick:O=>Y(t)},{default:s(()=>[...e[29]||(e[29]=[r("删除",-1)])]),_:1},8,["onClick"]),a(u,{size:"small",link:"",onClick:O=>B(S).push(`/service-needs/${t.id}`)},{default:s(()=>[...e[30]||(e[30]=[r("前台",-1)])]),_:1},8,["onClick"])])])}),128))]),o("div",_e,[a(c,{data:N.value,stripe:"",style:{width:"100%"}},{default:s(()=>[a(b,{prop:"id",label:"ID",width:"80"}),a(b,{prop:"title",label:"标题","min-width":"280"},{default:s(({row:t})=>{var k,z;return[o("div",we,[o("div",Ve,[o("span",ke,g(t.title),1),t.urgent?(w(),U("span",he,"紧急")):L("",!0)]),o("div",Te,g((k=t.owner)==null?void 0:k.org)+" · "+g((z=t.owner)==null?void 0:z.name),1)])]}),_:1}),a(b,{prop:"category",label:"分类",width:"120"}),a(b,{prop:"location",label:"区域",width:"140"}),a(b,{prop:"budget",label:"预算",width:"140"}),a(b,{prop:"deadline",label:"截止日期",width:"120"}),a(b,{prop:"status",label:"状态",width:"100"},{default:s(({row:t})=>[o("span",{class:I(["text-xs px-2 py-1 rounded-full",t.status==="进行中"?"bg-blue-50 text-blue-600":"bg-gray-100 text-gray-600"])},g(t.status),3)]),_:1}),a(b,{label:"操作",width:"160",fixed:"right"},{default:s(({row:t})=>[a(u,{text:"",type:"primary",onClick:k=>j(t)},{default:s(()=>[...e[31]||(e[31]=[r("编辑",-1)])]),_:1},8,["onClick"]),a(u,{text:"",type:"danger",onClick:k=>Y(t)},{default:s(()=>[...e[32]||(e[32]=[r("删除",-1)])]),_:1},8,["onClick"]),a(u,{text:"",onClick:k=>B(S).push(`/service-needs/${t.id}`)},{default:s(()=>[...e[33]||(e[33]=[r("前台",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),o("div",Ce,[a(_,{"current-page":V.page,"onUpdate:currentPage":e[4]||(e[4]=t=>V.page=t),"page-size":V.pageSize,"onUpdate:pageSize":e[5]||(e[5]=t=>V.pageSize=t),background:"",layout:"prev, pager, next",total:E.value.length},null,8,["current-page","page-size","total"])])]),a(X,{modelValue:x.visible,"onUpdate:modelValue":e[22]||(e[22]=t=>x.visible=t),title:x.mode==="create"?"新增需求":"编辑需求",width:"800px",top:"5vh"},{footer:s(()=>[o("div",De,[a(u,{onClick:e[21]||(e[21]=t=>x.visible=!1)},{default:s(()=>[...e[37]||(e[37]=[r("取消",-1)])]),_:1}),a(u,{type:"primary",onClick:R},{default:s(()=>[...e[38]||(e[38]=[r("保存",-1)])]),_:1})])]),default:s(()=>[a(W,{model:l,"label-width":"96px",class:"max-h-[70vh] overflow-y-auto pr-4"},{default:s(()=>[o("div",Ue,[a(d,{label:"标题",class:"col-span-2"},{default:s(()=>[a(m,{modelValue:l.title,"onUpdate:modelValue":e[6]||(e[6]=t=>l.title=t),placeholder:"请输入需求标题"},null,8,["modelValue"])]),_:1}),a(d,{label:"分类"},{default:s(()=>[a(y,{modelValue:l.category,"onUpdate:modelValue":e[7]||(e[7]=t=>l.category=t),filterable:"","allow-create":"","default-first-option":"",class:"w-full",placeholder:"请选择或输入分类"},{default:s(()=>[(w(!0),U($,null,M(F.value,t=>(w(),P(f,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"状态"},{default:s(()=>[a(y,{modelValue:l.status,"onUpdate:modelValue":e[8]||(e[8]=t=>l.status=t),class:"w-full",placeholder:"请选择状态"},{default:s(()=>[a(f,{label:"进行中",value:"进行中"}),a(f,{label:"已结束",value:"已结束"})]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"区域"},{default:s(()=>[a(m,{modelValue:l.location,"onUpdate:modelValue":e[9]||(e[9]=t=>l.location=t),placeholder:"例如：北京市 · 朝阳区"},null,8,["modelValue"])]),_:1}),a(d,{label:"预算"},{default:s(()=>[a(m,{modelValue:l.budget,"onUpdate:modelValue":e[10]||(e[10]=t=>l.budget=t),placeholder:"例如：¥50,000 / 月"},null,8,["modelValue"])]),_:1}),a(d,{label:"截止日期"},{default:s(()=>[a(G,{modelValue:l.deadline,"onUpdate:modelValue":e[11]||(e[11]=t=>l.deadline=t),type:"date","value-format":"YYYY-MM-DD",class:"w-full"},null,8,["modelValue"])]),_:1}),a(d,{label:"发布时间"},{default:s(()=>[a(G,{modelValue:l.publishTime,"onUpdate:modelValue":e[12]||(e[12]=t=>l.publishTime=t),type:"datetime","value-format":"YYYY-MM-DD HH:mm",class:"w-full"},null,8,["modelValue"])]),_:1}),a(d,{label:"紧急需求"},{default:s(()=>[a(J,{modelValue:l.urgent,"onUpdate:modelValue":e[13]||(e[13]=t=>l.urgent=t)},null,8,["modelValue"])]),_:1}),a(d,{label:"浏览量"},{default:s(()=>[a(Q,{modelValue:l.views,"onUpdate:modelValue":e[14]||(e[14]=t=>l.views=t),min:0,"controls-position":"right",class:"w-full"},null,8,["modelValue"])]),_:1})]),a(K,{"content-position":"left"},{default:s(()=>[...e[34]||(e[34]=[r("需求详情",-1)])]),_:1}),a(d,{label:"需求描述"},{default:s(()=>[a(m,{modelValue:l.desc,"onUpdate:modelValue":e[15]||(e[15]=t=>l.desc=t),type:"textarea",rows:3,placeholder:"简要描述需求背景与核心目标"},null,8,["modelValue"])]),_:1}),a(d,{label:"任务要求"},{default:s(()=>[a(m,{modelValue:l.requirementsText,"onUpdate:modelValue":e[16]||(e[16]=t=>l.requirementsText=t),type:"textarea",rows:4,placeholder:"每行一条任务要求"},null,8,["modelValue"])]),_:1}),a(d,{label:"交付成果"},{default:s(()=>[a(m,{modelValue:l.deliverablesText,"onUpdate:modelValue":e[17]||(e[17]=t=>l.deliverablesText=t),type:"textarea",rows:3,placeholder:"格式：成果名称 | 描述 | 格式（每行一条）"},null,8,["modelValue"]),e[35]||(e[35]=o("div",{class:"text-xs text-gray-400 mt-1"},"例如：日运输记录 | 每趟签收、温控曲线 | PDF/Excel",-1))]),_:1}),a(K,{"content-position":"left"},{default:s(()=>[...e[36]||(e[36]=[r("联系人信息",-1)])]),_:1}),o("div",ze,[a(d,{label:"单位名称","label-width":"80px"},{default:s(()=>[a(m,{modelValue:l.owner.org,"onUpdate:modelValue":e[18]||(e[18]=t=>l.owner.org=t),placeholder:"发布单位"},null,8,["modelValue"])]),_:1}),a(d,{label:"联系人","label-width":"80px"},{default:s(()=>[a(m,{modelValue:l.owner.name,"onUpdate:modelValue":e[19]||(e[19]=t=>l.owner.name=t),placeholder:"联系人姓名"},null,8,["modelValue"])]),_:1}),a(d,{label:"电话","label-width":"80px"},{default:s(()=>[a(m,{modelValue:l.owner.phone,"onUpdate:modelValue":e[20]||(e[20]=t=>l.owner.phone=t),placeholder:"联系电话"},null,8,["modelValue"])]),_:1})])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}};export{$e as default};
