import{B as G,r as i,o as F,a as H,c as M,e as m,h as e,i as t,w as o,j as d,q as p,F as I,k as U,p as c,s as w,ad as W,ae as K,t as r,af as P,f as R,g as Y,n as X,E as $}from"./index-U0bzlslD.js";import{m as Z}from"./mockNews-C-dTu_pP.js";const ee={class:"space-y-6"},te={class:"flex justify-between items-center"},le={class:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100"},se={class:"font-bold text-gray-700 mb-4 flex items-center gap-2"},oe={class:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6"},ae={class:"absolute -top-3 left-4 bg-gray-100 text-gray-500 text-xs px-2 py-1 rounded border border-gray-200 z-10"},ne={class:"bg-white rounded-lg shadow-sm overflow-hidden h-full flex flex-col"},ie={class:"h-40 relative bg-gray-100"},de=["src"],ce={key:1,class:"w-full h-full flex items-center justify-center text-gray-400"},re={class:"hidden md:flex absolute inset-0 bg-black/50 items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"},ue={class:"md:hidden absolute bottom-2 right-2"},_e={class:"p-3 md:p-4 flex-1 flex flex-col"},me={class:"flex items-center gap-2 mb-2"},pe={class:"bg-blue-50 text-blue-600 text-xs font-medium px-2 py-0.5 rounded"},ve={class:"text-gray-400 text-xs"},fe={class:"font-bold text-sm mb-2 line-clamp-2"},ge={class:"text-gray-500 text-xs line-clamp-2 flex-1"},he={class:"space-y-4"},be={class:"flex flex-col md:flex-row gap-2 md:gap-4"},ye={class:"hidden md:block"},xe=["src"],we={class:"md:hidden space-y-3 max-h-[400px] overflow-y-auto"},ke=["onClick"],Ce=["src"],Ne={class:"flex-1 min-w-0"},Ve={class:"font-medium text-sm text-gray-900 line-clamp-2 mb-1"},Se={class:"flex items-center justify-between"},je={class:"text-xs text-gray-400"},ze={key:0,class:"flex items-center justify-center text-blue-600"},Ee={class:"dialog-footer"},Le={__name:"AdminNewsFeatured",setup(Te){const S=i(window.innerWidth),j=()=>S.value=window.innerWidth;F(()=>window.addEventListener("resize",j)),H(()=>window.removeEventListener("resize",j));const A=M(()=>S.value<768),k=i(!1),b=i(!1),C=i(null),N=i(""),y=i(""),u=i(null),z=i(Z),v=i([{},{},{}]);F(()=>{const a=localStorage.getItem("featuredNews");a?v.value=JSON.parse(a):v.value=z.value.slice(0,3)});const E=M(()=>z.value.filter(a=>{const s=a.title.toLowerCase().includes(N.value.toLowerCase()),f=!y.value||a.category===y.value,_=v.value.some((V,g)=>g!==C.value&&V.id===a.id);return s&&f&&!_})),L=a=>{C.value=a,u.value=null,b.value=!0},T=a=>{u.value=a},D=()=>{u.value&&(v.value[C.value]={...u.value},b.value=!1,$.success("已更新推荐位内容，请记得保存！"))},J=()=>{k.value=!0,setTimeout(()=>{localStorage.setItem("featuredNews",JSON.stringify(v.value)),k.value=!1,$.success("首页推荐内容已保存")},800)};return(a,s)=>{const f=d("el-icon"),_=d("el-button"),V=d("el-input"),g=d("el-option"),O=d("el-select"),h=d("el-table-column"),B=d("el-tag"),q=d("el-table"),Q=d("el-dialog");return c(),m("div",ee,[e("div",te,[s[5]||(s[5]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-800"},"首页推荐管理"),e("p",{class:"text-gray-500 mt-1"},'管理首页 "新闻资讯" 栏目展示的 3 条置顶内容')],-1)),t(_,{type:"primary",onClick:J,loading:k.value},{default:o(()=>[t(f,{class:"mr-1"},{default:o(()=>[t(w(W))]),_:1}),s[4]||(s[4]=p(" 保存更改 ",-1))]),_:1},8,["loading"])]),e("div",le,[e("h3",se,[t(f,null,{default:o(()=>[t(w(K))]),_:1}),s[6]||(s[6]=p(" 首页展示预览 ",-1))]),e("div",oe,[(c(!0),m(I,null,U(v.value,(l,n)=>(c(),m("div",{key:n,class:"relative group border-2 border-dashed border-gray-200 rounded-xl p-2 hover:border-blue-400 transition-colors"},[e("div",ae," 推荐位 #"+r(n+1),1),e("div",ne,[e("div",ie,[l.cover?(c(),m("img",{key:0,src:l.cover,class:"w-full h-full object-cover"},null,8,de)):(c(),m("div",ce,[t(f,{size:32},{default:o(()=>[t(w(P))]),_:1})])),e("div",re,[t(_,{type:"primary",onClick:x=>L(n)},{default:o(()=>[...s[7]||(s[7]=[p(" 更换内容 ",-1)])]),_:1},8,["onClick"])]),e("div",ue,[t(_,{type:"primary",size:"small",circle:"",icon:"Edit",onClick:x=>L(n)},null,8,["onClick"])])]),e("div",_e,[e("div",me,[e("span",pe,r(l.category||"未分类"),1),e("span",ve,r(l.publishTime||"YYYY-MM-DD"),1)]),e("h4",fe,r(l.title||"暂无标题"),1),e("p",ge,r(l.desc||"暂无描述..."),1)])])]))),128))])]),t(Q,{modelValue:b.value,"onUpdate:modelValue":s[3]||(s[3]=l=>b.value=l),title:"选择新闻内容",width:A.value?"95%":"800px","destroy-on-close":"",class:"rounded-xl"},{footer:o(()=>[e("span",Ee,[t(_,{onClick:s[2]||(s[2]=l=>b.value=!1)},{default:o(()=>[...s[8]||(s[8]=[p("取消",-1)])]),_:1}),t(_,{type:"primary",onClick:D,disabled:!u.value},{default:o(()=>[...s[9]||(s[9]=[p(" 确定选择 ",-1)])]),_:1},8,["disabled"])])]),default:o(()=>[e("div",he,[e("div",be,[t(V,{modelValue:N.value,"onUpdate:modelValue":s[0]||(s[0]=l=>N.value=l),placeholder:"搜索标题...","prefix-icon":"Search",clearable:"",class:"flex-1"},null,8,["modelValue"]),t(O,{modelValue:y.value,"onUpdate:modelValue":s[1]||(s[1]=l=>y.value=l),placeholder:"全部分类",clearable:"",class:"w-full md:w-40"},{default:o(()=>[t(g,{label:"新品发布",value:"新品发布"}),t(g,{label:"用户故事",value:"用户故事"}),t(g,{label:"行业动态",value:"行业动态"}),t(g,{label:"政策法规",value:"政策法规"})]),_:1},8,["modelValue"])]),e("div",ye,[t(q,{data:E.value,height:"400",style:{width:"100%"},"highlight-current-row":"",onCurrentChange:T},{default:o(()=>[t(h,{width:"80"},{default:o(({row:l})=>[e("img",{src:l.cover,class:"w-10 h-10 rounded object-cover"},null,8,xe)]),_:1}),t(h,{prop:"title",label:"标题","min-width":"200","show-overflow-tooltip":""}),t(h,{prop:"category",label:"分类",width:"100"},{default:o(({row:l})=>[t(B,{size:"small"},{default:o(()=>[p(r(l.category),1)]),_:2},1024)]),_:1}),t(h,{prop:"author",label:"作者",width:"120"}),t(h,{prop:"publishTime",label:"发布时间",width:"120"}),t(h,{width:"80",align:"center"},{default:o(({row:l})=>{var n;return[((n=u.value)==null?void 0:n.id)===l.id?(c(),R(_,{key:0,type:"success",size:"small",circle:"",icon:"Check"})):Y("",!0)]}),_:1})]),_:1},8,["data"])]),e("div",we,[(c(!0),m(I,null,U(E.value,l=>{var n,x;return c(),m("div",{key:l.id,class:X(["bg-gray-50 p-3 rounded-lg border border-gray-100 flex gap-3",{"ring-2 ring-blue-500 bg-blue-50":((n=u.value)==null?void 0:n.id)===l.id}]),onClick:Be=>T(l)},[e("img",{src:l.cover,class:"w-16 h-16 object-cover rounded bg-white shrink-0"},null,8,Ce),e("div",Ne,[e("div",Ve,r(l.title),1),e("div",Se,[t(B,{size:"small",effect:"plain"},{default:o(()=>[p(r(l.category),1)]),_:2},1024),e("span",je,r(l.publishTime),1)])]),((x=u.value)==null?void 0:x.id)===l.id?(c(),m("div",ze,[t(f,null,{default:o(()=>[t(w(W))]),_:1})])):Y("",!0)],10,ke)}),128))])])]),_:1},8,["modelValue","width"])])}}},Ie=G(Le,[["__scopeId","data-v-5c8ff835"]]);export{Ie as default};
