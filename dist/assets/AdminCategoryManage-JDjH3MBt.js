import{B as oe,r as y,c as h,e as _,h as o,i as t,j as d,w as n,t as b,F as $,k as z,p as c,q as m,s as se,ac as de,f as B,g as R,a0 as ie,E as S}from"./index-U0bzlslD.js";const ue={class:"space-y-6"},re={class:"flex flex-col md:flex-row md:justify-between md:items-center gap-4"},ce={class:"flex flex-col md:flex-row gap-4"},me={class:"hidden md:block bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"},pe={class:"p-4 border-b border-gray-100 flex items-center justify-between bg-gray-50/50"},_e={class:"flex items-center gap-4"},ve={class:"text-gray-500 text-sm"},fe={class:"flex items-center gap-2 group"},ge={class:"font-medium text-gray-700"},xe={class:"opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-1 ml-4"},ye={class:"md:hidden space-y-4"},be={class:"flex justify-between items-start mb-3"},he={class:"font-bold text-gray-900 text-lg flex items-center gap-2"},ke={class:"text-xs text-gray-500 mt-1"},we={class:"flex gap-2"},Ve={key:0,class:"pl-4 border-l-2 border-gray-100 space-y-3"},Ce={class:"flex justify-between items-center"},Ie={class:"font-medium text-gray-700"},Ue={class:"flex items-center gap-1"},Ee={class:"flex justify-between items-center mt-2 text-xs text-gray-500"},$e={key:1,class:"text-xs text-gray-400 pl-4 py-2 italic"},ze={class:"dialog-footer"},Be={__name:"AdminCategoryManage",setup(Se){const j=y(""),v=y(!1),f=y("add"),g=y([]),p=y([{id:1,name:"行业资讯",sort:1,status:!0,parentId:null,children:[{id:11,name:"政策法规",sort:1,status:!0,parentId:1},{id:12,name:"行业动态",sort:2,status:!0,parentId:1},{id:13,name:"企业动态",sort:3,status:!0,parentId:1}]},{id:2,name:"招标信息",sort:2,status:!0,parentId:null,children:[{id:21,name:"设备采购",sort:1,status:!0,parentId:2},{id:22,name:"服务招标",sort:2,status:!0,parentId:2}]},{id:3,name:"政策法规",sort:3,status:!0,parentId:null,children:[]},{id:4,name:"关于我们",sort:4,status:!1,parentId:null,children:[]}]),q=h(()=>p.value.map(s=>({id:s.id,name:s.name}))),u=y({id:null,name:"",parentId:null,sort:0,status:!0}),L=s=>{g.value=s},V=h(()=>g.value.length),D=h(()=>g.value.length>0&&g.value.length===A.value.length),O=h(()=>g.value.length>0&&g.value.length<A.value.length),A=h(()=>{let s=[];const e=r=>{r.forEach(a=>{s.push(a),a.children&&e(a.children)})};return e(p.value),s}),Q=s=>{},G=()=>{f.value="add",u.value={id:null,name:"",parentId:null,sort:0,status:!0},v.value=!0},M=s=>{f.value="add-sub",u.value={id:null,name:"",parentId:s.id,sort:0,status:!0},v.value=!0},C=s=>{f.value="edit",u.value={...s},v.value=!0},I=s=>{ie.confirm("确定要删除该栏目吗？如果该栏目下有子栏目，将一并删除。","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{H(s.id),S.success("删除成功")})},H=s=>{const e=r=>{const a=r.findIndex(x=>x.id===s);if(a>-1)return r.splice(a,1),!0;for(const x of r)if(x.children&&e(x.children))return!0;return!1};e(p.value)},J=()=>{if(!u.value.name){S.warning("请输入栏目名称");return}if(f.value==="edit")K(u.value);else{const s=Date.now(),e={...u.value,id:s,children:[]};if(e.parentId){const r=p.value.find(a=>a.id===e.parentId);r&&(r.children||(r.children=[]),r.children.push(e))}else p.value.push(e)}v.value=!1,S.success("保存成功")},K=s=>{const e=r=>{for(let a of r){if(a.id===s.id)return Object.assign(a,s),!0;if(a.children&&e(a.children))return!0}return!1};e(p.value)};return(s,e)=>{const r=d("el-input"),a=d("el-button"),x=d("el-checkbox"),W=d("el-icon"),U=d("el-dropdown-item"),X=d("el-dropdown-menu"),Y=d("el-dropdown"),k=d("el-table-column"),N=d("el-input-number"),T=d("el-switch"),Z=d("el-table"),ee=d("el-tag"),P=d("el-option"),le=d("el-select"),w=d("el-form-item"),F=d("el-radio"),te=d("el-radio-group"),ne=d("el-form"),ae=d("el-dialog");return c(),_("div",ue,[o("div",re,[e[9]||(e[9]=o("div",null,[o("h1",{class:"text-xl md:text-2xl font-bold text-gray-900"},"栏目管理"),o("p",{class:"text-gray-500 text-xs md:text-sm mt-1"},"管理内容分类体系，支持二级分类结构")],-1)),o("div",ce,[t(r,{modelValue:j.value,"onUpdate:modelValue":e[0]||(e[0]=l=>j.value=l),placeholder:"搜索栏目...","prefix-icon":"Search",class:"w-full md:w-64"},null,8,["modelValue"]),t(a,{type:"primary",icon:"Plus",onClick:G,class:"w-full md:w-auto"},{default:n(()=>[...e[8]||(e[8]=[m("添加栏目",-1)])]),_:1})])]),o("div",me,[o("div",pe,[o("div",_e,[t(x,{modelValue:D.value,"onUpdate:modelValue":e[1]||(e[1]=l=>D.value=l),indeterminate:O.value,onChange:Q},null,8,["modelValue","indeterminate"]),t(Y,{trigger:"click",disabled:V.value===0},{dropdown:n(()=>[t(X,null,{default:n(()=>[t(U,null,{default:n(()=>[...e[11]||(e[11]=[m("启用",-1)])]),_:1}),t(U,null,{default:n(()=>[...e[12]||(e[12]=[m("禁用",-1)])]),_:1}),t(U,{divided:"",type:"danger"},{default:n(()=>[...e[13]||(e[13]=[m("删除",-1)])]),_:1})]),_:1})]),default:n(()=>[t(a,{disabled:V.value===0},{default:n(()=>[e[10]||(e[10]=m(" 批量操作 ",-1)),t(W,{class:"el-icon--right"},{default:n(()=>[t(se(de))]),_:1})]),_:1},8,["disabled"])]),_:1},8,["disabled"]),o("span",ve,"已选中 "+b(V.value)+" 项",1)])]),t(Z,{data:p.value,"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},onSelectionChange:L,class:"w-full"},{default:n(()=>[t(k,{type:"selection",width:"55"}),t(k,{label:"栏目名称","min-width":"300"},{default:n(({row:l})=>[o("div",fe,[o("span",ge,b(l.name),1),o("div",xe,[t(a,{link:"",type:"primary",icon:"Edit",onClick:i=>C(l)},null,8,["onClick"]),l.parentId?R("",!0):(c(),B(a,{key:0,link:"",type:"success",icon:"Plus",onClick:i=>M(l)},null,8,["onClick"])),t(a,{link:"",type:"danger",icon:"Delete",onClick:i=>I(l)},null,8,["onClick"])])])]),_:1}),t(k,{label:"排序",width:"150",align:"center"},{default:n(({row:l})=>[t(N,{modelValue:l.sort,"onUpdate:modelValue":i=>l.sort=i,"controls-position":"right",size:"small",class:"w-24"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(k,{label:"状态",width:"120",align:"center"},{default:n(({row:l})=>[t(T,{modelValue:l.status,"onUpdate:modelValue":i=>l.status=i,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","active-value":!0,"inactive-value":!1},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])]),o("div",ye,[(c(!0),_($,null,z(p.value,l=>(c(),_("div",{key:l.id,class:"bg-white rounded-xl shadow-sm border border-gray-100 p-4"},[o("div",be,[o("div",null,[o("div",he,[m(b(l.name)+" ",1),l.status?R("",!0):(c(),B(ee,{key:0,type:"info",size:"small",effect:"plain"},{default:n(()=>[...e[14]||(e[14]=[m("禁用",-1)])]),_:1}))]),o("div",ke,"排序: "+b(l.sort),1)]),o("div",we,[t(a,{size:"small",circle:"",icon:"Plus",type:"success",plain:"",onClick:i=>M(l)},null,8,["onClick"]),t(a,{size:"small",circle:"",icon:"Edit",type:"primary",plain:"",onClick:i=>C(l)},null,8,["onClick"]),t(a,{size:"small",circle:"",icon:"Delete",type:"danger",plain:"",onClick:i=>I(l)},null,8,["onClick"])])]),l.children&&l.children.length>0?(c(),_("div",Ve,[(c(!0),_($,null,z(l.children,i=>(c(),_("div",{key:i.id,class:"bg-gray-50 rounded-lg p-3"},[o("div",Ce,[o("div",Ie,b(i.name),1),o("div",Ue,[t(a,{link:"",size:"small",icon:"Edit",onClick:E=>C(i)},null,8,["onClick"]),t(a,{link:"",size:"small",icon:"Delete",type:"danger",onClick:E=>I(i)},null,8,["onClick"])])]),o("div",Ee,[o("span",null,"排序: "+b(i.sort),1),t(T,{modelValue:i.status,"onUpdate:modelValue":E=>i.status=E,size:"small","inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])):(c(),_("div",$e,"暂无子栏目"))]))),128))]),t(ae,{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=l=>v.value=l),title:f.value==="add"?"添加栏目":"编辑栏目",width:"500px"},{footer:n(()=>[o("span",ze,[t(a,{onClick:e[6]||(e[6]=l=>v.value=!1)},{default:n(()=>[...e[17]||(e[17]=[m("取消",-1)])]),_:1}),t(a,{type:"primary",onClick:J},{default:n(()=>[...e[18]||(e[18]=[m("确定",-1)])]),_:1})])]),default:n(()=>[t(ne,{model:u.value,"label-width":"80px"},{default:n(()=>[t(w,{label:"上级栏目"},{default:n(()=>[t(le,{modelValue:u.value.parentId,"onUpdate:modelValue":e[2]||(e[2]=l=>u.value.parentId=l),class:"w-full",disabled:!!u.value.parentId&&f.value==="add-sub"},{default:n(()=>[t(P,{label:"顶级栏目",value:null}),(c(!0),_($,null,z(q.value,l=>(c(),B(P,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),t(w,{label:"栏目名称"},{default:n(()=>[t(r,{modelValue:u.value.name,"onUpdate:modelValue":e[3]||(e[3]=l=>u.value.name=l),placeholder:"请输入栏目名称"},null,8,["modelValue"])]),_:1}),t(w,{label:"排序"},{default:n(()=>[t(N,{modelValue:u.value.sort,"onUpdate:modelValue":e[4]||(e[4]=l=>u.value.sort=l),min:0},null,8,["modelValue"])]),_:1}),t(w,{label:"状态"},{default:n(()=>[t(te,{modelValue:u.value.status,"onUpdate:modelValue":e[5]||(e[5]=l=>u.value.status=l)},{default:n(()=>[t(F,{label:!0},{default:n(()=>[...e[15]||(e[15]=[m("启用",-1)])]),_:1}),t(F,{label:!1},{default:n(()=>[...e[16]||(e[16]=[m("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},De=oe(Be,[["__scopeId","data-v-172c45d6"]]);export{De as default};
